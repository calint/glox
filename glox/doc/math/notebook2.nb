(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     48238,       1375]
NotebookOptionsPosition[     47314,       1340]
NotebookOutlinePosition[     47743,       1359]
CellTagsIndexPosition[     47700,       1356]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "\"\<*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.549954769973887*^9, {3.5499580767285967`*^9, 3.5499580798918056`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sphere", "/", "sphere"}], " ", "collision", " ", "resolver"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"1.", "x"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"1.", "y"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"1.", "z"}]]}], "}"}]}], ";"}], 
   RowBox[{"(*", "position", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["u", "1"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"1.", "x"}]], ",", 
       SubscriptBox["u", 
        RowBox[{"1.", "y"}]], ",", 
       SubscriptBox["u", 
        RowBox[{"1.", "z"}]]}], "}"}]}], ";"}], 
   RowBox[{"(*", "velocity", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", "1"], ";"}], " ", 
   RowBox[{"(*", "radius", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"2.", "x"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"2.", "y"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"2.", "z"}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["u", "2"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"2.", "x"}]], ",", 
       SubscriptBox["u", 
        RowBox[{"2.", "y"}]], ",", 
       SubscriptBox["u", 
        RowBox[{"2.", "z"}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["r", "2"], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "+", 
         RowBox[{
          SubscriptBox["u", "1"], "t"}]}], ",", 
        RowBox[{
         SubscriptBox["p", "2"], "+", 
         RowBox[{
          SubscriptBox["u", "2"], "t"}]}]}], "]"}], "\[Equal]", 
      RowBox[{
       SubscriptBox["r", "1"], "+", 
       SubscriptBox["r", "2"]}]}], ",", "t"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5499443001618557`*^9, 3.549944570235422*^9}, {
   3.5499446778792973`*^9, 3.5499446851043043`*^9}, {3.549944717914577*^9, 
   3.5499447628114853`*^9}, {3.5499449232853823`*^9, 3.549945030267845*^9}, {
   3.549945119514237*^9, 3.5499452362530613`*^9}, {3.549945285470325*^9, 
   3.549945891208911*^9}, {3.549945931800774*^9, 3.5499459891270103`*^9}, {
   3.5499460785149393`*^9, 3.549946128248087*^9}, {3.5499461618674383`*^9, 
   3.5499463020369577`*^9}, {3.549946339911528*^9, 3.5499464179173517`*^9}, {
   3.549946483848427*^9, 3.549946568980342*^9}, {3.549946599573805*^9, 
   3.549946612542385*^9}, {3.5499499345495*^9, 3.549949935199751*^9}, {
   3.549953994916876*^9, 3.549953996310563*^9}, {3.549954357847908*^9, 
   3.549954376815138*^9}, {3.549954407575333*^9, 3.549954427617628*^9}, {
   3.549954464418742*^9, 3.549954467731267*^9}, 3.549954547000288*^9, {
   3.549954726756495*^9, 3.549954765262496*^9}, {3.549957927961714*^9, 
   3.5499579411573143`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "x"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "x"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "x"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "x"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "y"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "y"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "y"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "y"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "z"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "z"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "z"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "z"}]]}], "-", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "x"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "x"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "y"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "y"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "z"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "z"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "z"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "z"}]]}]}], ")"}], "2"], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["p", 
               RowBox[{"1.`", " ", "x"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"2.`", " ", "x"}], "2"], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"1.`", " ", "y"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"2.`", " ", "y"}], "2"], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"1.`", " ", "z"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "z"}]]}], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"2.`", " ", "z"}], "2"], "-", 
              SubsuperscriptBox["r", "1", "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["r", "1"], " ", 
               SubscriptBox["r", "2"]}], "-", 
              SubsuperscriptBox["r", "2", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["u", 
               RowBox[{"1.`", " ", "x"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"2.`", " ", "x"}], "2"], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"1.`", " ", "y"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"2.`", " ", "y"}], "2"], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"1.`", " ", "z"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "z"}]]}], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"2.`", " ", "z"}], "2"]}], ")"}]}]}], ")"}]}]}], ")"}],
       "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["u", 
           RowBox[{"1.`", " ", "x"}], "2"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["u", 
            RowBox[{"1.`", " ", "x"}]], " ", 
           SubscriptBox["u", 
            RowBox[{"2.`", " ", "x"}]]}], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"2.`", " ", "x"}], "2"], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"1.`", " ", "y"}], "2"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["u", 
            RowBox[{"1.`", " ", "y"}]], " ", 
           SubscriptBox["u", 
            RowBox[{"2.`", " ", "y"}]]}], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"2.`", " ", "y"}], "2"], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"1.`", " ", "z"}], "2"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["u", 
            RowBox[{"1.`", " ", "z"}]], " ", 
           SubscriptBox["u", 
            RowBox[{"2.`", " ", "z"}]]}], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"2.`", " ", "z"}], "2"]}], ")"}]}], ")"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "x"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "x"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "x"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "x"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "x"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "y"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "y"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "y"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "y"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "y"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "z"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"1.`", " ", "z"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"1.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "z"}]]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["p", 
          RowBox[{"2.`", " ", "z"}]], " ", 
         SubscriptBox["u", 
          RowBox[{"2.`", " ", "z"}]]}], "+", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "x"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "x"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "y"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "y"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "z"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "z"}]]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "z"}]]}], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "z"}]]}]}], ")"}], "2"], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["p", 
               RowBox[{"1.`", " ", "x"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"2.`", " ", "x"}], "2"], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"1.`", " ", "y"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"2.`", " ", "y"}], "2"], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"1.`", " ", "z"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["p", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["p", 
                RowBox[{"2.`", " ", "z"}]]}], "+", 
              SubsuperscriptBox["p", 
               RowBox[{"2.`", " ", "z"}], "2"], "-", 
              SubsuperscriptBox["r", "1", "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["r", "1"], " ", 
               SubscriptBox["r", "2"]}], "-", 
              SubsuperscriptBox["r", "2", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["u", 
               RowBox[{"1.`", " ", "x"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "x"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "x"}]]}], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"2.`", " ", "x"}], "2"], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"1.`", " ", "y"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "y"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "y"}]]}], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"2.`", " ", "y"}], "2"], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"1.`", " ", "z"}], "2"], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["u", 
                RowBox[{"1.`", " ", "z"}]], " ", 
               SubscriptBox["u", 
                RowBox[{"2.`", " ", "z"}]]}], "+", 
              SubsuperscriptBox["u", 
               RowBox[{"2.`", " ", "z"}], "2"]}], ")"}]}]}], ")"}]}]}], ")"}],
       "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["u", 
           RowBox[{"1.`", " ", "x"}], "2"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["u", 
            RowBox[{"1.`", " ", "x"}]], " ", 
           SubscriptBox["u", 
            RowBox[{"2.`", " ", "x"}]]}], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"2.`", " ", "x"}], "2"], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"1.`", " ", "y"}], "2"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["u", 
            RowBox[{"1.`", " ", "y"}]], " ", 
           SubscriptBox["u", 
            RowBox[{"2.`", " ", "y"}]]}], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"2.`", " ", "y"}], "2"], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"1.`", " ", "z"}], "2"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["u", 
            RowBox[{"1.`", " ", "z"}]], " ", 
           SubscriptBox["u", 
            RowBox[{"2.`", " ", "z"}]]}], "+", 
          SubsuperscriptBox["u", 
           RowBox[{"2.`", " ", "z"}], "2"]}], ")"}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.549958070132275*^9, 3.549958084497842*^9}, 
   3.549958132410787*^9, {3.549958200459532*^9, 3.549958202704814*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "if", " ", "overlapping", " ", "pick", " ", "nearest", " ", "t"}], "<", 
     "0"}], ",", " ", 
    RowBox[{
     RowBox[{
     "for", " ", "collision", " ", "detection", " ", "check", " ", "t"}], ">", 
     RowBox[{"0", " ", "and", " ", "t"}], "<", "1"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["np", "1"], "=", 
     RowBox[{
      SubscriptBox["p", "1"], "+", 
      RowBox[{
       SubscriptBox["u", "1"], "t"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"move", " ", "out", " ", "of", " ", "collision"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["np", "2"], "=", 
     RowBox[{
      SubscriptBox["p", "2"], "+", 
      RowBox[{
       SubscriptBox["u", "2"], "t"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nml", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       SubscriptBox["np", "1"], "-", 
       SubscriptBox["np", "2"]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"collision", " ", "plane", " ", "normal"}], "*)"}], 
    "\[IndentingNewLine]", 
    SubscriptBox["m", "1"], ";", 
    RowBox[{"(*", "mass", "*)"}], "\[IndentingNewLine]", 
    SubscriptBox["m", "2"], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "     ", 
    RowBox[{
    "velocity", " ", "given", "    ", "velocities", " ", "received", " ", 
     "along", " ", "collision", " ", "plane", " ", "normal"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["v", "1"], "=", 
     RowBox[{
      SubscriptBox["u", "1"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", "1"], ".", "nml"}], ")"}], "nml"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", "1"], ".", "nml"}], ")"}], "nml", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "-", 
           SubscriptBox["m", "2"]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", "2"], ".", "nml"}], ")"}], "nml", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          SubscriptBox["m", "2"], "/", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["m", "1"], "+", 
            SubscriptBox["m", "2"]}], ")"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["v", "2"], "=", 
     RowBox[{
      SubscriptBox["u", "2"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", "2"], ".", "nml"}], ")"}], "nml"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", "2"], ".", "nml"}], ")"}], "nml", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "2"], "-", 
           SubscriptBox["m", "1"]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["u", "1"], ".", "nml"}], ")"}], "nml", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          SubscriptBox["m", "1"], "/", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["m", "1"], "+", 
            SubscriptBox["m", "2"]}], ")"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["np", "1"], "=", 
     RowBox[{
      SubscriptBox["np", "1"], "+", 
      RowBox[{
       SubscriptBox["v", "1"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "t"}], ")"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "perform", " ", "remaining", " ", "dt", " ", "with", " ", "new", " ", 
     "velocities"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["np", "2"], "=", 
     RowBox[{
      SubscriptBox["np", "2"], "+", 
      RowBox[{
       SubscriptBox["v", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "t"}], ")"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.549957953913067*^9, 3.549957955037427*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["v", "1"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", "1"], ".", "nml"}], ")"}], "nml", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["m", "1"], "-", 
         SubscriptBox["m", "2"]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", "2"], ".", "nml"}], ")"}], "nml", 
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{
        SubscriptBox["m", "2"], "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"]}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "2"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", "2"], ".", "nml"}], ")"}], "nml", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["m", "2"], "-", 
         SubscriptBox["m", "1"]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", "1"], ".", "nml"}], ")"}], "nml", 
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{
        SubscriptBox["m", "1"], "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"]}], ")"}]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["m", "1"], 
     SubscriptBox["u", "1"]}], "+", 
    RowBox[{
     SubscriptBox["m", "2"], 
     SubscriptBox["u", "2"]}]}], "==", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "1"], 
     SubscriptBox["v", "1"]}], "+", 
    RowBox[{
     SubscriptBox["m", "2"], 
     SubscriptBox["v", "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5499579631417828`*^9, 3.549958034901256*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sphere", "/", "plane"}], " ", "collision", " ", "resolver"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["p", "g"], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dot", " ", "on", " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "g"], "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], "]"}]}], ";"}], 
   RowBox[{"(*", "normal", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1.5", ",", "0"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"sphere", " ", "position"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";"}], 
   RowBox[{"(*", "velocity", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", "1"}], ";"}], 
   RowBox[{"(*", "radius", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Remove", "[", "t", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"u", " ", "t"}], "-", 
          SubscriptBox["p", "g"]}], ")"}], ".", 
        SubscriptBox["n", "g"]}], "-", "r"}], "\[Equal]", "0"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"signed", " ", "distance", " ", "to", " ", "plane"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{"f", ",", "t"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", ".5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"pick", " ", "nearest", " ", "t"}], "<", "0"}], ",", " ", 
     RowBox[{"t", ">", 
      RowBox[{"1", " ", "or", " ", "t"}], "<", 
      RowBox[{
      "0", " ", "collision", " ", "is", " ", "in", " ", "future", " ", "or", 
       " ", "past"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"np", "=", 
    RowBox[{"p", "+", 
     RowBox[{"u", " ", "t"}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"move", " ", "sphere", " ", "out", " ", "of", " ", "collision"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"v", "=", 
    RowBox[{"u", "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"u", ".", 
        SubscriptBox["n", "g"]}], ")"}], 
      SubscriptBox["n", "g"]}]}]}], 
   RowBox[{"(*", "reflect", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"np", "=", 
    RowBox[{"np", "+", 
     RowBox[{"v", 
      RowBox[{"(", 
       RowBox[{"1", "-", "t"}], ")"}], 
      RowBox[{"(*", 
       RowBox[{"second", " ", "part", " ", "of", " ", "dt"}], 
       "*)"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.549952563200015*^9, 3.5499527515628147`*^9}, {
  3.549952783815399*^9, 3.549953063055554*^9}, {3.549953098276946*^9, 
  3.549953132322912*^9}, {3.54995321295258*^9, 3.549953255181548*^9}, {
  3.54995328907563*^9, 3.549953356360284*^9}, {3.5499534079036283`*^9, 
  3.549953498493186*^9}, {3.549953563257236*^9, 3.549953684483563*^9}, {
  3.549953734053131*^9, 3.5499538592365913`*^9}, {3.549953890909725*^9, 
  3.549953955796255*^9}}],

Cell[BoxData[
 RowBox[{"$DisplayFunction", "[", 
  GraphicsBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQ7ZX64uKBl6F2DFDQyLFZvVNyij2MHxG5cP2Hj0vg
fO7/jTHucuvhfNXAdy8Od2+B88vPWdrP+LITzhffIniPkXE/nL/tkfOZ8zaH
4PxDWXOlI98cgfO/qtnyr809Ducz/VwtIK16Cs43+5+wLXjdGTj/TIvJuWNa
5+F8+Qmvf658dwHOf/39/r2rBpfg/CWvdp/i67sM5/PJLn//5MkVOL8nc2va
ApVrcP43h9VPMuqvw/klRke2iB2+AeffX3ek+6LiLTj/d9aV2ZpVt+F8bUf2
f2m778D57osU0zeK30OEl2y80sOY+3C+zptQ7uu+D+B8Yf4PHEd+Ifgs+2ev
V57zEM7PNtl9k9P7EZy/2jNpwb5vCP7X11ICz6Y9hvO3BrszT3F5AufXe7TO
3/IMwVe863VjcetTON/KvGWKpNEzOD9G7vxPxssI/tdTvY8KGp/D+TNY4kqC
VF4g3H9v6yKmIwg+a21jiGXhSzifYWXc+kdCr+D8olnre4UOIfh7tTs4BPNe
w/mCXkU6TXxv4Pw7uhcuV+5B8DfMs1d5EvcWzo9dbyYo+w/Bb2hd2Hhn1Ts4
f+0L2dl8Pu/h/Ony3F///0fwAW77zh0=
    "], {}],
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   AxesOrigin->{0, 0},
   PlotRange->{{0, 1}, {0., 1.}},
   PlotRangeClipping->True,
   PlotRangePadding->{
     Scaled[0.02], 
     Scaled[0.02]}], "]"}]], "Output",
 CellChangeTimes->{{3.5499532932252083`*^9, 3.549953357490469*^9}, {
   3.549953399302655*^9, 3.549953499484692*^9}, {3.549953635280698*^9, 
   3.5499536425253*^9}, {3.549953673462579*^9, 3.549953687577194*^9}, {
   3.549953739908084*^9, 3.549953860019014*^9}, {3.5499538935314074`*^9, 
   3.549953956504228*^9}, 3.549954224760841*^9, {3.549954288572954*^9, 
   3.54995430019942*^9}, {3.54995473540197*^9, 3.549954746143916*^9}, 
   3.549954777846195*^9, {3.5499580702785788`*^9, 3.549958084674404*^9}, {
   3.549958199969248*^9, 3.549958202868866*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"t", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1.`"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.5`"}], "+", 
       RowBox[{"1.`", " ", 
        SubscriptBox[
         RowBox[{"{", 
          RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], "g"]}]}], ")"}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.5499532932252083`*^9, 3.549953357490469*^9}, {
   3.549953399302655*^9, 3.549953499484692*^9}, {3.549953635280698*^9, 
   3.5499536425253*^9}, {3.549953673462579*^9, 3.549953687577194*^9}, {
   3.549953739908084*^9, 3.549953860019014*^9}, {3.5499538935314074`*^9, 
   3.549953956504228*^9}, 3.549954224760841*^9, {3.549954288572954*^9, 
   3.54995430019942*^9}, {3.54995473540197*^9, 3.549954746143916*^9}, 
   3.549954777846195*^9, {3.5499580702785788`*^9, 3.549958084674404*^9}, {
   3.549958199969248*^9, 3.54995820288521*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5499532932252083`*^9, 3.549953357490469*^9}, {
   3.549953399302655*^9, 3.549953499484692*^9}, {3.549953635280698*^9, 
   3.5499536425253*^9}, {3.549953673462579*^9, 3.549953687577194*^9}, {
   3.549953739908084*^9, 3.549953860019014*^9}, {3.5499538935314074`*^9, 
   3.549953956504228*^9}, 3.549954224760841*^9, {3.549954288572954*^9, 
   3.54995430019942*^9}, {3.54995473540197*^9, 3.549954746143916*^9}, 
   3.549954777846195*^9, {3.5499580702785788`*^9, 3.549958084674404*^9}, {
   3.549958199969248*^9, 3.5499582028882313`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.5499532932252083`*^9, 3.549953357490469*^9}, {
   3.549953399302655*^9, 3.549953499484692*^9}, {3.549953635280698*^9, 
   3.5499536425253*^9}, {3.549953673462579*^9, 3.549953687577194*^9}, {
   3.549953739908084*^9, 3.549953860019014*^9}, {3.5499538935314074`*^9, 
   3.549953956504228*^9}, 3.549954224760841*^9, {3.549954288572954*^9, 
   3.54995430019942*^9}, {3.54995473540197*^9, 3.549954746143916*^9}, 
   3.549954777846195*^9, {3.5499580702785788`*^9, 3.549958084674404*^9}, {
   3.549958199969248*^9, 3.54995820289108*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "1.5`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5499532932252083`*^9, 3.549953357490469*^9}, {
   3.549953399302655*^9, 3.549953499484692*^9}, {3.549953635280698*^9, 
   3.5499536425253*^9}, {3.549953673462579*^9, 3.549953687577194*^9}, {
   3.549953739908084*^9, 3.549953860019014*^9}, {3.5499538935314074`*^9, 
   3.549953956504228*^9}, 3.549954224760841*^9, {3.549954288572954*^9, 
   3.54995430019942*^9}, {3.54995473540197*^9, 3.549954746143916*^9}, 
   3.549954777846195*^9, {3.5499580702785788`*^9, 3.549958084674404*^9}, {
   3.549958199969248*^9, 3.549958202893839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.549953825741261*^9, 3.549953827010201*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}], ",", "0"}], "}"}], 
         RowBox[{"1.`", " ", "x"}]]}], "+", 
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"2.`", " ", "x"}]]}], ")"}], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "x"}]]}], "+", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "x"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "x"}]]}], "-", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "x"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "x"}]]}], "-", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "y"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "y"}]]}], "+", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "y"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "y"}]]}], "+", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "y"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "y"}]]}], "-", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "y"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "y"}]]}], "-", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "z"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "z"}]]}], "+", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "z"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "z"}]]}], "+", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"1.`", " ", "z"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "z"}]]}], "-", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "z"}]], " ", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
      RowBox[{"2.`", " ", "z"}]]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], 
                RowBox[{"1.`", " ", "x"}]], "-", 
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], 
                RowBox[{"2.`", " ", "x"}]]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
                RowBox[{"1.`", " ", "x"}]], "-", 
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
                RowBox[{"2.`", " ", "x"}]]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], 
                RowBox[{"1.`", " ", "y"}]], "-", 
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], 
                RowBox[{"2.`", " ", "y"}]]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
                RowBox[{"1.`", " ", "y"}]], "-", 
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
                RowBox[{"2.`", " ", "y"}]]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], 
                RowBox[{"1.`", " ", "z"}]], "-", 
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], 
                RowBox[{"2.`", " ", "z"}]]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
                RowBox[{"1.`", " ", "z"}]], "-", 
               SubscriptBox[
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
                RowBox[{"2.`", " ", "z"}]]}], ")"}]}]}], ")"}], "2"]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "x"}]], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "x"}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "y"}]], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "y"}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "z"}]], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "z"}]]}], ")"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "x"}]], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "x"}]]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "y"}]], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "y"}]]}], ")"}], "2"], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["1", "1"], "+", 
              SubscriptBox["1", "2"], "+", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "z"}]], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "z"}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["1", "1"], "+", 
              SubscriptBox["1", "2"], "-", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"1.`", " ", "z"}]], "+", 
              SubscriptBox[
               RowBox[{"{", 
                RowBox[{"0", ",", "1.5`", ",", "0"}], "}"}], 
               RowBox[{"2.`", " ", "z"}]]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"1.`", " ", "x"}]], "-", 
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"2.`", " ", "x"}]]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"1.`", " ", "y"}]], "-", 
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"2.`", " ", "y"}]]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"1.`", " ", "z"}]], "-", 
       SubscriptBox[
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], 
        RowBox[{"2.`", " ", "z"}]]}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5499582702602377`*^9}]
}, Open  ]]
},
WindowSize->{740, 620},
WindowMargins->{{105, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
CellContext->"d4`",
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 179, 4, 27, "Input"],
Cell[CellGroupData[{
Cell[761, 28, 3180, 87, 153, "Input"],
Cell[3944, 117, 17576, 462, 338, "Output"]
}, Open  ]],
Cell[21535, 582, 4347, 141, 189, "Input"],
Cell[25885, 725, 2150, 79, 58, "Input"],
Cell[CellGroupData[{
Cell[28060, 808, 3476, 97, 255, "Input"],
Cell[31539, 907, 1554, 30, 79, "Output"],
Cell[33096, 939, 919, 21, 33, "Output"],
Cell[34018, 962, 645, 10, 27, "Output"],
Cell[34666, 974, 636, 10, 27, "Output"],
Cell[35305, 986, 644, 10, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35986, 1001, 92, 1, 27, "Input"],
Cell[36081, 1004, 11217, 333, 307, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
